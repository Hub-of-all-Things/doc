<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["http","shell"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="http">http</a>
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Hub-of-All-Things API!</p>

<p>Hub-of-All-Things is a platform for a Multi-Sided Market powered by the Internet of Things.</p>

<p>The HAT code is publicly available on <a href="http://github.com/Hub-of-all-Things/HAT2.0">GitHub</a></p>

<h2 id="license">License</h2>

<p>The documentation is released under <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International</a></p>

<p><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</a></p>

<h2 id="about-the-hat">About the HAT</h2>

<p>A Personal Data Management System (“the HAT”) is a personal single tenant (“the individual self”) technology system that is fully individual self-service, to enable an individual to define a full set of “meta-data” defining as a specific set of personal data, personal preferences, personal behaviour events. The HAT allows individuals to share the right information (quality and quantity), with the right people, in the right situations for the right purposes and gain the benefits.</p>

<p>The HAT and its personal data ecosystem is designed to allow individual HAT Users to collect, contextualise and exchange their personal data. The enabling technology for the HAT sits within the HATPDP, (mostly referred as “HAT”). The Personal HAT is a person “oriented” personal data platform, owned by the individuals, that allows us to unpick the silos in which our personal data sits and to collect all this data which we can acquire from internet-connected objects or services. The HAT then allow the transformation of this acquired data for individuals to contextualise and organise, to make it meaningful and useful for control decisions and actions. With that data, individuals can buy apps to analyse, view, create scenarios, trade or make important decisions based on our own data for a smarter and more effective life. The HAT is therefore a fully scalable platform that allows firms to offer individuals services for our personal data, and yet enables us as individuals to personalise that data to our own needs.</p>

<p>The APIs detailed in this document detail how this functionality is achieved.</p>

<h2 id="the-application-programming-interface-api">The Application Programming Interface (API)</h2>

<p>The Application Programming Interface (API) of the HAT is designed to facilitate communication between individual HATs and services that use their data using the standard JSON data format. The APIs are split into inbound, outbound and management:</p>

<ul>
<li>Inbound ones are used by data sources to provide data to HATs and use the flexible data schema. </li>
<li>Outbound APIs operate with the Data Debit mechanism, where the user approves each data user with each kind of data to be retrieved. They facilitate the only method of retrieving data from a HAT. </li>
<li>Management APIs are used by the Hyperdata Browser to contextualise data, control Data Debits, authorisation, applications and other management functons. </li>
</ul>

<p>APIs provide users with help in contextualising their data as well as suggesting to the overall ecosystem (users and applications) what data bundles would be beneficial to have and what other data sources would bring the most value when connected to the HAT.</p>

<h1 id="user-management">User Management</h1>

<p>The HAT and its personal data ecosystem are designed to allow individual HAT Users to collect, contextualise and exchange our personal Data. The enabling technology for the HAT sits within the HAT Personal Data Platform (HATPDP, mostly referred to as &ldquo;HAT&rdquo;). With their Data, individuals can buy apps to analyse, view, create scenarios, trade or make important decisions based on our own Data for a smarter and more effective life. HAT is therefore a fully scalable platform that allows firms to offer individuals services for our personal data, and yet enables us as individuals to personalise that data to our own needs. Therefore, there are 4 Account <em>roles</em> defined within the HAT: </p>

<ul>
<li>Owner - a User who has access to everything within the HAT and who <em>owns</em> it</li>
<li>Direct Data Credit (<code class="prettyprint">dataCredit</code>) can create/record data, but cannot read it Raw Data, unless accessit it via a user-approved Direct Debit</li>
<li>Direct Data Debit (<code class="prettyprint">dataDebit</code>) can read the Data that Owner enabled for sharing and exchange through Direct Data Debits</li>
<li>Platform (<code class="prettyprint">platform</code>), that manages Data Credit and Debit accounts, e.g. creates then when an application developer wants an account on a user&rsquo;s HAT</li>
</ul>

<p>A HAT can be described as being analogous to an email account. As an individual HAT User, we can choose our HAT provider (also known as HPP in the HAT ecosystem) just like we choose our email account provider, and we can switch HPPs as there may be many such providers. Or, if you want to host your own HAT, your Personal HAT can be configured to sit on your private server. By signing up for a HAT with a HPP, you become Owner of your HAT and you are provided with a Universally Unique Identifier (UUID) to serve as the identification for your HAT. UUID, an identifier standard used in software construction, is simply a 128-bit value, where the meaning of each bit is defined by any of several variants. A UUID in a HAT may take a DNS (domain name service) type approach; for example, Alice&rsquo;s HAT may be certified as alice.user.hubofallthings.com.</p>

<h2 id="authentication">Authentication</h2>

<p>For both the Data import and export, the virtualised database will required permissions to ensure that a User has authorised certain API consumers to add or read the data from the various Tables within the database. For this, separate “Apps” that represent API User accounts will be present within each User’s PDS. Each App will own several permission sets within the database, which will determine which Tables the API consumers are able to access, in addition to the permissions the API consumers have on those Tables.</p>

<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight shell"><code>
curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/</span><span class="nv">$API_ENDPOINT</span><span class="s2">"</span>
</code></pre>
<pre class="highlight http"><code><span class="err">
</span><span class="nf">GET</span> <span class="nn">API_ENDPOINT</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

</code></pre>

<blockquote>
<p>Make sure to replace <code class="prettyprint">ACCESS_TOKEN</code> with your API access token, as well as the other variables for the JSON contents of the url, the API endpoint and the address of the HAT you are interacting with.</p>
</blockquote>

<h3 id="acquiring-access-token">Acquiring Access Token</h3>

<p>The tokens used are JWT tokens and you can see the values set by the HAT (such as the issuer) at <a href="jwt.io">jwt.io</a>. To acquire an access token, you should make a GET request to <code class="prettyprint">/user/access_token</code> endpoint and the request should contain headers with <code class="prettyprint">username</code> and <code class="prettyprint">pass</code> (password). The response will contain the access token and user ID.</p>

<blockquote>
<p>Example of acquiring Access Token:</p>
</blockquote>
<pre class="highlight shell"><code>curl -X GET -H <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"username: andy"</span> <span class="se">\</span>
  -H <span class="s2">"password: testing"</span> <span class="se">\</span>
  <span class="s2">"http://andy.hubofallthings.net/users/access_token"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/users/access_token</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>Example of response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"accessToken"</span>: <span class="s2">"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJoYXQiLCJyZXNvdXJjZSI6ImFuZHkuaHVib2ZhbGx0aGluZ3MubmV0IiwiYWNjZXNzU2NvcGUiOiJvd25lciIsImlzcyI6ImFuZHkuaHVib2ZhbGx0aGluZ3MubmV0IiwiZXhwIjoxNDY4MDg2ODM5fQ.JI3Mj1669AZ47zanVS5l3TqE6k8yJL0dX-XDycwJ3IR8zXmRSUYx_AGmqhbSRdAkLB15OBOTIupC4pMQ2k8UwWfB-l-5sC00nDyWHQU1M3Ac-DRu1xS9XKnNa0nzdqkFOKQKoeGJdEVtZY7OZsgvdeC68e55no6l4M7nKmVURZAwynStz0sQMMbP84tM516jXKlx9diZfTkvhOR68pQj0eV6llUZUjfkkCHSC1gD3pUbw-j7mTEp99Hl8qvn_tLizdhgJyoFYWBkUZSdTXXyH-gSvNDPQNrax_83iNX4__1XHBeHABD3Z9oroQNGWuLX7HoPbZzdV6xu3Qh4uz9Zmg"</span>,
  <span class="s2">"userId"</span>: <span class="s2">"62b885fa-abc4-4bea-adc7-bc907f862132"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"accessToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJoYXQiLCJyZXNvdXJjZSI6ImFuZHkuaHVib2ZhbGx0aGluZ3MubmV0IiwiYWNjZXNzU2NvcGUiOiJvd25lciIsImlzcyI6ImFuZHkuaHVib2ZhbGx0aGluZ3MubmV0IiwiZXhwIjoxNDY4MDg2ODM5fQ.JI3Mj1669AZ47zanVS5l3TqE6k8yJL0dX-XDycwJ3IR8zXmRSUYx_AGmqhbSRdAkLB15OBOTIupC4pMQ2k8UwWfB-l-5sC00nDyWHQU1M3Ac-DRu1xS9XKnNa0nzdqkFOKQKoeGJdEVtZY7OZsgvdeC68e55no6l4M7nKmVURZAwynStz0sQMMbP84tM516jXKlx9diZfTkvhOR68pQj0eV6llUZUjfkkCHSC1gD3pUbw-j7mTEp99Hl8qvn_tLizdhgJyoFYWBkUZSdTXXyH-gSvNDPQNrax_83iNX4__1XHBeHABD3Z9oroQNGWuLX7HoPbZzdV6xu3Qh4uz9Zmg"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"62b885fa-abc4-4bea-adc7-bc907f862132"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="validating-access-token">Validating Access Token</h3>

<p>Tokens are signed by the HAT’s public key using RSA algorithm so that their authenticity can be independently verified. To make sure the provided access token works with the specific HAT, make a GET request containing a header with <code class="prettyprint">X-Auth-Token</code> to <code class="prettyprint">/users/access_token/validate</code> endpoint. In case of a valid access token, your response will say <code class="prettyprint">&quot;message&quot;: &quot;Authenticated&quot;</code> and in a case of an invalid access token, you will get <code class="prettyprint">&quot;message&quot;: &quot;The supplied authentication is invalid&quot;</code> and <code class="prettyprint">&quot;cause&quot;: &quot;...&quot;</code>.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://hat.hubofallthings.net/</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>access_token</td>
<td>your access token used to authenticate</td>
</tr>
<tr>
<td>username</td>
<td>username used for authentication together with password, instead of access_token (user and platform only)</td>
</tr>
<tr>
<td>pass</td>
<td>password used for authentication together with username, instead of access_token (user and platform only)</td>
</tr>
</tbody></table>

<aside class="notice">
You must replace <code>ACCESS_TOKEN</code> with your application&rsquo;s API access token.
</aside>

<h2 id="direct-credit-and-debit-accounts">Direct Credit and Debit Accounts</h2>

<p>Data Credit Account can create/record a Raw Data, whilst Data Debit Account can read the Data that Owner decided to share and exchange. For more detailed information about how the Direct Data Debit (D3) System works, see section &ldquo;Sharing and Direct Data Debits&rdquo; at the end of this document.</p>

<h3 id="creating-accounts">Creating Accounts</h3>

<p>To create a new <code class="prettyprint">User</code>, the API request body should contain a new User <code class="prettyprint">ID</code>, <code class="prettyprint">email</code>, <code class="prettyprint">pass</code> (password, which is bcrypt-hashed as application developers would request the paltform provider to create an account on their behalf) <code class="prettyprint">name</code> and <code class="prettyprint">role</code>. Role can be defined as <code class="prettyprint">dataDebit</code> or <code class="prettyprint">dataCredit</code>. The special <code class="prettyprint">owner</code> and <code class="prettyprint">platform</code> accounts can only be created at the time of creating a HAT and can not be added/replaced/disabled later. The API request should then be posted to <code class="prettyprint">/users/user</code> endpoint. </p>

<blockquote>
<p>Example of creating a new Direct Debit Account:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'{
     "userId": "5974832d-2dc1-4f49-adf1-c6d8bc790275",
     "email": "apiClient@platform.com",
     "pass": "$2a$10$6YoHtQqSdit9zzVSzrkK7.E.JQuioFNAggTY7vZRL4RSeY.sUbUIu",
     "name": "apiclient.platform.com",
     "role": "dataDebit"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/users/user"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/users/user</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5974832d-2dc1-4f49-adf1-c6d8bc790275"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"apiClient@platform.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$2a$10$6YoHtQqSdit9zzVSzrkK7.E.JQuioFNAggTY7vZRL4RSeY.sUbUIu"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"apiclient.platform.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataDebit"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Note that pass is bcrypt salted hash of simplepass.</p>

<p>Example of response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"userId"</span>: <span class="s2">"5974832d-2dc1-4f49-adf1-c6d8bc790275"</span>,
  <span class="s2">"email"</span>: <span class="s2">"apiClient@platform.com"</span>,
  <span class="s2">"name"</span>: <span class="s2">"apiclient.platform.com"</span>,
  <span class="s2">"role"</span>: <span class="s2">"dataDebit"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5974832d-2dc1-4f49-adf1-c6d8bc790275"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"apiClient@platform.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"apiclient.platform.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dataDebit"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="enabling-disabling-accounts">Enabling/Disabling Accounts</h3>

<p>The <code class="prettyprint">owner</code> enable or disable any Direct Debit Account. To do this, they should make an API request using PUT to <code class="prettyprint">/users/user/UUID/enable</code> or <code class="prettyprint">/users/user/UUID/disable</code> endpoint to enable or disable the account respectively. Note that the API request body should be left empty and that UUID is a Universally Unique Identifier used for <code class="prettyprint">userId</code>. </p>

<blockquote>
<p>Example of enabling an Account:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -PUT <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/users/user/UUID/enable"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">PUT</span> <span class="nn">/users/user/UUID/enable</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code>OK
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="err">OK</span><span class="w">
</span></code></pre>

<h1 id="raw-data-input-and-output">Raw Data Input and Output</h1>

<p>The Raw Data level provides a flexible substrate for users to import a varying range of data. This is achieved through a virtualised database, allowing data providers to accurately map their existing data schemas to a user’s HAT through sets of: </p>

<ul>
<li>Tables</li>
<li>Fields</li>
<li>Records</li>
<li>Values</li>
<li>Table Relationships</li>
<li>Data Record Relationships</li>
</ul>

<p><img title="Raw Data Structures" alt="Raw Data Structures" src="images/dataStructures.png" /></p>

<h2 id="data-sources">Data Sources</h2>

<p>Raw Data can be collected from Sources that have an open API. Data Sources can include: internet-connected devices, databases, online calendars, Facebook, etc. Each Source with an open API, however, returns the Data in some structure. Therefore, you have to configure each new Data Source you want to use.</p>

<h3 id="configure-a-new-data-source">Configure a new Data Source</h3>

<p>When creating a new Data Source for the HAT, you have to define the structure of the data that you will be using to format your input data. We work with a <em>virtualized</em> data structure, meaning that we can create any number of Tables, subTables and Fields within them that are necessary.</p>

<p>The basic rules are:</p>

<ul>
<li>if it is a simple value (a leaf of a JSON tree), it will be stored as a <code class="prettyprint">Field</code>;</li>
<li>if it is a more complex object (JSON object with child nodes), it will be stored as a <code class="prettyprint">Table</code>;</li>
<li>each <code class="prettyprint">Table</code> (or <code class="prettyprint">subTable</code>) can have 0 or more <code class="prettyprint">Fields</code>;</li>
<li>if an object is part of another object or is the root object (node) of the JSON tree, it will be stored as a <code class="prettyprint">Table</code>/<code class="prettyprint">subTable</code>. Any objects that are part of it will be stored as <code class="prettyprint">subTables</code>;</li>
<li>each Table and each Field has a <code class="prettyprint">name</code>. The names are used when reconstructing stored data back into JSON as property names;</li>
<li>each Field currently has a mandatory source name to avoid name clashes between unrelated data sources.</li>
</ul>

<aside class="info">
The <code>source</code> field will not be modifiable by the API caller from the next release of the HAT and it will be used to control who owns the specific tables (the same user who has created them) and hence who can write into them.
</aside>

<aside class="warning">
Make sure to save the structure for yourself for each user you are storing the data for as you will need field IDs to define which fields to write your data values into.
</aside>

<blockquote>
<p>Example of configuring a new data source:</p>
</blockquote>
<pre class="highlight shell"><code>
curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
    "name": "kitchen",
    "source": "fibaro",
    "fields": [
      { "name": "tableTestField" },
      { "name": "tableTestField2" }
    ],
    "subTables": [
      {
        "name": "kitchenElectricity",
        "source": "fibaro",
        "fields": [
          { "name": "tableTestField3" },
          { "name": "tableTestField4" }
        ]
      }
    ]
  }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/table"</span>

</code></pre>
<pre class="highlight http"><code><span class="err">
</span><span class="nf">POST</span> <span class="nn">/data/table</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchen"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField2"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"subTables"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchenElectricity"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField3"</span><span class="w"> </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField4"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchen"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> 
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w"> 
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField2"</span><span class="p">,</span><span class="w"> 
      </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nt">"subTables"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchenElectricity"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> 
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField3"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w"> 
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField4"</span><span class="p">,</span><span class="w"> 
          </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-08-16T21:45:22.551Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h3 id="listing-available-sources">Listing Available Sources</h3>

<p>You might want to check what Sources have been already configured before configuring a new one. To list all available Sources, you should make a GET request to <code class="prettyprint">/data/sources</code> endpoint. The response will contain a list of Sources, where each <code class="prettyprint">Source</code> contains a list of Data <code class="prettyprint">Tables</code> that are not part of another Table (i.e. they are not subTables). In addition to this, the response will show IDs of the Sources and times when they were created as well as updated. </p>

<blockquote>
<p>Example of listing available Sources:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/sources"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/data/sources</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"My Static Data"</span>,
    <span class="s2">"source"</span>: <span class="s2">"MyStaticRecords"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-02T22:35:17Z"</span>,
    <span class="s2">"id"</span>: 16,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-02T22:35:17Z"</span>
  <span class="o">}</span>,
  <span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"HyperDataBrowser"</span>,
    <span class="s2">"source"</span>: <span class="s2">"HyperDataBrowser"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-10-29T15:41:28Z"</span>,
    <span class="s2">"id"</span>: 100,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-10-29T15:41:28Z"</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My Static Data"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyStaticRecords"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-02T22:35:17Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-02T22:35:17Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HyperDataBrowser"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HyperDataBrowser"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-29T15:41:28Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-29T15:41:28Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<h2 id="data-tables">Data Tables</h2>

<p>Data Tables are used for raw (incoming) Data. Data Tables define how sets of Data Fields and subTables should be grouped together into the Data Table structures. For example, a Data Table can contain Fields and subTables as showed in the diagram in Raw Data Input and Output introduction above.</p>

<h3 id="data-table-structure">Data Table Structure</h3>

<p>All Table API calls contain all the information defined in Table Structure. If you want to create a new Table, you have to include all the mandatory information in the API request. Table structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>table ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the table was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the table was updated</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the table</td>
<td>mandatory</td>
</tr>
<tr>
<td>source</td>
<td>source of the table</td>
<td>mandatory</td>
</tr>
<tr>
<td>fields</td>
<td>fiels that the table contains</td>
<td>optional</td>
</tr>
<tr>
<td>subTables</td>
<td>subtables that the table contains</td>
<td>optional</td>
</tr>
</tbody></table>

<h3 id="creating-a-new-data-table">Creating a new Data Table</h3>

<p>You should create a new <code class="prettyprint">table</code> for every set of Values you want to be added to a particular table. For example, if a user is importing their Facebook data, they may wish to create a separate Table for the schools they have attended, and a separate Table for the Facebook Pages that they “Like”. To create a new <code class="prettyprint">Table</code>, the API request body should contain a new Table <code class="prettyprint">name</code> and <code class="prettyprint">source</code> and it should be posted to <code class="prettyprint">/data/table</code> endpoint. The new Table ID and times when it was created as well as updated will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of creating a new Table:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'{
       "name": "kitchen",
       "source": "fibaro"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/table"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/data/table</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchen"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Example of response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"name"</span>: <span class="s2">"kitchen"</span>,
  <span class="s2">"source"</span>: <span class="s2">"fibaro"</span>,
  <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-22T20:54:41Z"</span>,
  <span class="s2">"id"</span>: 13,
  <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-22T20:54:41Z"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchen"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T20:54:41Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T20:54:41Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="filtering-tables">Filtering Tables</h3>

<p>You might need to extract some information about a particular Table, e.g. a list of subTables it contains. You can retrieve information about that Table using a GET request and specifying ID of that Table. For example, to find the Table with ID = 13, include its ID in the URL, i.e. post it to <code class="prettyprint">/data/table/13</code> endpoint.</p>

<blockquote>
<p>Example of finding a particular Table by ID:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/table/TABLE_ID?"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/data/table/TABLE_ID</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>TABLE_ID must be replaced with the ID of the Table you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"name"</span>: <span class="s2">"kitchen"</span>,
  <span class="s2">"source"</span>: <span class="s2">"fibaro"</span>,
  <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-22T20:54:41Z"</span>,
  <span class="s2">"subTables"</span>: <span class="o">[]</span>,
  <span class="s2">"id"</span>: 13,
  <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-22T20:54:41Z"</span>,
  <span class="s2">"fields"</span>: <span class="o">[]</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchen"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T20:54:41Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"subTables"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T20:54:41Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="data-records">Data Records</h2>

<p>Data Records define how sets of Data Values should be grouped together into the Data Table structures, i.e. each Record is equivalent of a Table row. For visual explanation of what Data Record is, see the diagram in Raw Data Input and Output introduction above.</p>

<h3 id="record-structure">Record Structure</h3>

<p>All Record API calls contain all the information defined in Record Structure. If you want to create a new Record, you have to include all the mandatory information in the API request. Record structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>record ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the record was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the record was updated</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the record</td>
<td>mandatory</td>
</tr>
</tbody></table>

<h3 id="creating-a-new-record">Creating a new Record</h3>

<p>You should create a new <code class="prettyprint">record</code> for every set of Values you want to be treated as a single record. For example, each GPS reading with separate longitude and latitude Values can be put in a Record that contains both longitude and latitude, together with additional properties such as the timestamp of the Record. To create a new <code class="prettyprint">Record</code>, the API request body should contain a new Record <code class="prettyprint">name</code> and it should be posted to <code class="prettyprint">/data/record</code> endpoint. The new Record ID and times when it was created as well as updated will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of creating a new Record:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'{
    "name": "testNewRecord"
  }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/record"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/data/record</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testNewRecord"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Example of response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 39,
  <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-22T17:22:57Z"</span>,
  <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-22T17:22:57Z"</span>,
  <span class="s2">"name"</span>: <span class="s2">"newRecord"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T17:22:57Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T17:22:57Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"newRecord"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="filling-data-structures">Filling Data Structures</h3>

<p>Currently the easiest way of putting new data into the HAT is to POST it to the <code class="prettyprint">/record/RECORDID/values</code> API endpoint, formatted as in the provided examples. RECORDID is extracted separately for each Record from the response of the API call to create a new Record. In this case you submit a list of values that each contain the value itself and the field it should be putin, together with its <code class="prettyprint">ID</code> and <code class="prettyprint">name</code>.</p>

<aside class="info">
Because multiple Data Fields can have the same name but different IDs, ID is mandatory to disambiguate where exactly data should be inserted.
</aside>

<blockquote>
<p>Example of filling data structures:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'[
     {
       "value": "testValue2-1",
       "field": 
           { 
             "id": 2,
             "name": "tableTestField" 
           }
     },
     {
       "value": "testValue2-2",
       "field": 
           { 
             "id": 3,
             "name": "tableTestField-3" 
           }
     }
   ]'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/record/RECORD_ID/values"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/data/record/RECORD_ID/values</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testValue2-1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w"> 
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField"</span><span class="w"> 
        </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testValue2-2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w"> 
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField-3"</span><span class="w"> 
        </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<blockquote>
<p>RECORD_ID must be replaced with the ID of the Record you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
  <span class="o">{</span>
     <span class="s2">"id"</span>: 361,
     <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-10-13T18:18:08+01:00"</span>,
     <span class="s2">"dateCreated"</span>: <span class="s2">"2015-10-13T18:18:08+01:00"</span>,
     <span class="s2">"value"</span>: <span class="s2">"testValue2-1"</span>,
     <span class="s2">"field"</span>: 
     <span class="o">{</span>
       <span class="s2">"id"</span>: 2,
       <span class="s2">"name"</span>: <span class="s2">"tableTestField"</span>
     <span class="o">}</span>
  <span class="o">}</span>, 
  <span class="o">{</span>
     <span class="s2">"id"</span>: 362,
     <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-10-13T18:18:08+01:00"</span>,
     <span class="s2">"dateCreated"</span>: <span class="s2">"2015-10-13T18:18:08+01:00"</span>,
     <span class="s2">"value"</span>: <span class="s2">"testValue2-2"</span>,
     <span class="s2">"field"</span>: 
     <span class="o">{</span>
       <span class="s2">"id"</span>: 3,
       <span class="s2">"name"</span>: <span class="s2">"tableTestField3"</span>
     <span class="o">}</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
     </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">361</span><span class="p">,</span><span class="w">
     </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-13T18:18:08+01:00"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-13T18:18:08+01:00"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testValue2-1"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
     </span><span class="p">{</span><span class="w">
       </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
       </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField"</span><span class="w">
     </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
     </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">362</span><span class="p">,</span><span class="w">
     </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-13T18:18:08+01:00"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-13T18:18:08+01:00"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testValue2-2"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
     </span><span class="p">{</span><span class="w">
       </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
       </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField3"</span><span class="w">
     </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre>

<blockquote>
<p>RECORD_ID must be replaced with the ID of the record you have just created with a <code class="prettyprint">POST</code> to <code class="prettyprint">/data/record</code></p>
</blockquote>

<h3 id="creating-a-new-record-and-filling-its-data-structures-together">Creating a New Record and Filling its Data Structures Together</h3>

<p>If data structure Values are known before a new Record needs to be created, it tends to be useful to create a new <code class="prettyprint">Record</code> and fill its data structures with <code class="prettyprint">Values</code> in one go. To do this, the API request body should contain a new <code class="prettyprint">Record</code> <code class="prettyprint">name</code> and a list of <code class="prettyprint">values</code> and it should be posted to <code class="prettyprint">/data/record/values</code> endpoint. The new Record ID and times when it was created as well as updated will be recorded automatically and included in the response. Note that you can create a list of new Records by simply defining a list of them in the API request body.</p>

<aside class="notice">
The API accepts a list of pairs of Records with values.
</aside>

<aside class="info">
Because multiple Data Fields can have the same name but different IDs, ID is mandatory to disambiguate where exactly data should be inserted.
</aside>

<blockquote>
<p>Example of creating a new Record and filling it in one go:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'{
     "record": 
     {
       "lastUpdated": "2015-11-22T21:24:44Z",
       "name": "kitchenElectricityRow"
     },
     "values": 
     [
       {
         "field": 
         {
           "id": 10,
           "name": "month2014"
         },
         "value": "september2014"
       },
       {
         "field": 
         {
           "id": 11,
           "name": "month2015"
         },
         "value": "september2015"
       }
     ]
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/record/values"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/data/record/values</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"record"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:24:44Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchenElectricityRow"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"values"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month2014"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"september2014"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month2015"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"september2015"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"record"</span>: 
  <span class="o">{</span>
    <span class="s2">"id"</span>: 40,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-22T21:24:44Z"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-22T21:24:44Z"</span>,
    <span class="s2">"name"</span>: <span class="s2">"kitchenElectricityRow"</span>
  <span class="o">}</span>,
  <span class="s2">"values"</span>: 
  <span class="o">[</span>
    <span class="o">{</span>
      <span class="s2">"field"</span>: 
      <span class="o">{</span>
        <span class="s2">"id"</span>: 10,
        <span class="s2">"tableId"</span>: 23,
        <span class="s2">"name"</span>: <span class="s2">"month2014"</span>
      <span class="o">}</span>,
      <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-22T21:24:44Z"</span>,
      <span class="s2">"id"</span>: 390,
      <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-22T21:24:44Z"</span>,
      <span class="s2">"value"</span>: <span class="s2">"september2014"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
      <span class="s2">"field"</span>: 
      <span class="o">{</span>
        <span class="s2">"id"</span>: 11,
        <span class="s2">"tableId"</span>: 24,
        <span class="s2">"name"</span>: <span class="s2">"month2015"</span>
      <span class="o">}</span>,
      <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-22T21:24:44Z"</span>,
      <span class="s2">"id"</span>: 391,
      <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-22T21:24:44Z"</span>,
      <span class="s2">"value"</span>: <span class="s2">"september2015"</span>
    <span class="o">}</span>
  <span class="o">]</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"record"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:24:44Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:24:44Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchenElectricityRow"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"values"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
        </span><span class="nt">"tableId"</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month2014"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:24:44Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">390</span><span class="p">,</span><span class="w">
      </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:24:44Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"september2014"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
        </span><span class="nt">"tableId"</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"month2015"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:24:44Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">391</span><span class="p">,</span><span class="w">
      </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:24:44Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"september2015"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="data-field">Data Field</h2>

<p>As showed in the diagram in Raw Data Input and Output introduction above, Data Field is equivalent to Table column. Data Field belongs to a Table and corresponds to JSON Property which holds a Value. </p>

<h3 id="field-structure">Field Structure</h3>

<p>All Field API calls contain all the information defined in Field Structure. If you want to create a new Field, you have to include all the mandatory information in the API request. Field structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>field ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the field was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the field was updated</td>
<td>optional</td>
</tr>
<tr>
<td>tableId</td>
<td>ID of the table that the field belongs to</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the field</td>
<td>mandatory</td>
</tr>
<tr>
<td>values</td>
<td>data values that the field contains</td>
<td>optional</td>
</tr>
</tbody></table>

<h2 id="data-value">Data Value</h2>

<p>JSON Values, that are simple string values, are stored in Fields. See the diagram in Raw Data Input and Output introduction above for visual explanation where a Value sits within Field, Record and Table structure.</p>

<h3 id="value-structure">Value Structure</h3>

<p>All Value API calls contain all the information defined in Value Structure. If you want to create a new Value, you have to include all the mandatory information in the API request. Value structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>value ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the value was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the value was updated</td>
<td>optional</td>
</tr>
<tr>
<td>value</td>
<td>some string</td>
<td>mandatory</td>
</tr>
<tr>
<td>field</td>
<td>field that the value belongs to</td>
<td>optional</td>
</tr>
<tr>
<td>record</td>
<td>record that the value belongs to</td>
<td>optional</td>
</tr>
</tbody></table>

<h3 id="creating-a-value-within-field-and-record">Creating a Value within Field and Record</h3>

<p>To create a new <code class="prettyprint">Value</code>, the API request body should contain a new Value <code class="prettyprint">value</code> in a form of string and it should be posted to <code class="prettyprint">/value</code> endpoint. Note that values should be related to particular Fields and Records, therefore you should include Field and Record <code class="prettyprint">names</code> and <code class="prettyprint">IDs</code> that you want to store the new Value. Note that you can create a list of new Values by simply defining a list of them in the API request body.</p>

<blockquote>
<p>Example of creating a new Property:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
     "value": "testValue",
     "field": 
     { 
       "id": 2,
       "name": "tableTestField" 
     },
     "record": 
     {
       "id": 40,
       "name": "kitchenElectricityRow"
     }
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/property"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/value</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
  "value": "testValue",
  "field": 
  { 
    "id": 2,
    "name": "tableTestField" 
  },
  "record": 
  {
    "id": 40,
    "name": "kitchenElectricityRow"
  }
}
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"field"</span>: 
  <span class="o">{</span>
    <span class="s2">"id"</span>: 2,
    <span class="s2">"name"</span>: <span class="s2">"tableTestField"</span>
  <span class="o">}</span>,
  <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-22T21:45:22Z"</span>,
  <span class="s2">"id"</span>: 394,
  <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-22T21:45:22Z"</span>,
  <span class="s2">"value"</span>: <span class="s2">"testValue"</span>,
  <span class="s2">"record"</span>: 
  <span class="o">{</span>
    <span class="s2">"id"</span>: 40,
    <span class="s2">"name"</span>: <span class="s2">"kitchenElectricityRow"</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"field"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tableTestField"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:45:22Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">394</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-22T21:45:22Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testValue"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"record"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchenElectricityRow"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="retrieving-raw-data">Retrieving Raw Data</h2>

<p>Sometimes you might find it useful to extract Data Values. You can get all <code class="prettyprint">Data</code> that has been stored in a specific <code class="prettyprint">Table</code> (including its <code class="prettyprint">Fields</code> and <code class="prettyprint">subTables</code>), listed by associated <code class="prettyprint">Record</code> ID (one Record per list item), and the full nested structure of Fields and subTables. Similarly, you can query the Data by Field (individual JSON Property) to get a list of all items that are stored in that Field. You can also get all values associated with a Record ID, in the form of the full, nested structure of Tables, subTables, Fields and Values. You can retrieve Data Values by specifying Table, Field or Record ID and making a GET request to <code class="prettyprint">/table/table_ID/values</code>, <code class="prettyprint">/field/field_ID/values</code> or <code class="prettyprint">/record/record_ID/values</code> respectively.</p>

<aside class="info">
Raw data retrieval is only available for the <em>Owner</em> user for the use by the personal HAT User Interface. It may, however, be useful in development to better understand how the HAT works as well as to help you structure your data.
</aside>

<blockquote>
<p>Example of extracting Table Values:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/data/table/TABLE_ID/values"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/data/table/TABLE_ID/values</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>TABLE_ID must be replaced with the ID of the Table you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"profile0"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-05T06:19:01Z"</span>,
    <span class="s2">"id"</span>: 34,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-05T06:19:01Z"</span>,
    <span class="s2">"tables"</span>: 
    <span class="o">[</span>
      <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"profile"</span>,
        <span class="s2">"source"</span>: <span class="s2">"facebook"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
        <span class="s2">"subTables"</span>: 
        <span class="o">[</span>
          <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"hometown"</span>,
            <span class="s2">"source"</span>: <span class="s2">"facebook"</span>,
            <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
            <span class="s2">"subTables"</span>: <span class="o">[]</span>,
            <span class="s2">"id"</span>: 2,
            <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
            <span class="s2">"fields"</span>: 
            <span class="o">[</span>
              <span class="o">{</span>
                <span class="s2">"name"</span>: <span class="s2">"id"</span>,
                <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
                <span class="s2">"id"</span>: 19,
                <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
                <span class="s2">"tableId"</span>: 2,
                <span class="s2">"values"</span>: 
                <span class="o">[</span>
                  <span class="o">{</span>
                    <span class="s2">"id"</span>: 356,
                    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-05T06:19:01Z"</span>,
                    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-05T06:19:01Z"</span>,
                    <span class="s2">"value"</span>: <span class="s2">"101877916520606"</span>
                  <span class="o">}</span>
                <span class="o">]</span>
              <span class="o">}</span>
            <span class="o">]</span>
          <span class="o">}</span>
        <span class="o">]</span>,
        <span class="s2">"id"</span>: 1,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
        <span class="s2">"fields"</span>: <span class="o">[</span>
          <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"id"</span>,
            <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
            <span class="s2">"id"</span>: 1,
            <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T22:43:13Z"</span>,
            <span class="s2">"tableId"</span>: 1,
            <span class="s2">"values"</span>: <span class="o">[</span>
              <span class="o">{</span>
                <span class="s2">"id"</span>: 351,
                <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-05T06:19:01Z"</span>,
                <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-05T06:19:01Z"</span>,
                <span class="s2">"value"</span>: <span class="s2">"10207930600321182"</span>
              <span class="o">}</span>
            <span class="o">]</span>
          <span class="o">}</span>
        <span class="o">]</span>
      <span class="o">}</span>
    <span class="o">]</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"profile0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-05T06:19:01Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-05T06:19:01Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tables"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"profile"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"facebook"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"subTables"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hometown"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"facebook"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"subTables"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"fields"</span><span class="p">:</span><span class="w"> 
            </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w">
                </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"tableId"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nt">"values"</span><span class="p">:</span><span class="w"> 
                </span><span class="p">[</span><span class="w">
                  </span><span class="p">{</span><span class="w">
                    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">356</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-05T06:19:01Z"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-05T06:19:01Z"</span><span class="p">,</span><span class="w">
                    </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"101877916520606"</span><span class="w">
                  </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"fields"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"id"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T22:43:13Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"tableId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"values"</span><span class="p">:</span><span class="w"> 
            </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">351</span><span class="p">,</span><span class="w">
                </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-05T06:19:01Z"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-05T06:19:01Z"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10207930600321182"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<h1 id="contextualisation">Contextualisation</h1>

<p>Each user will be able to &ldquo;contextualise&rdquo; their Data in a way it makes sense to them through a complete set of APIs into the 5 categories (Data Tables):</p>

<ul>
<li>People - yourself and the people you interact with;</li>
<li>Things - what you use or interact with, especially those IoT devices; Things represent both virtual and physical objects;</li>
<li>Events - what happens to you or what you do in time;</li>
<li>Locations - where is the stuff around you happening;</li>
<li>Organisations - what organisations or institutions activities relate to.</li>
</ul>

<p>A connected home, for example, where a sensor measures when a door is opened or closed, could be modelled as a Thing, as well as someone’s Google Calendar with several Events linked to them. Essentially, Things are a “catch all” Table, in where objects (real or conceptual), that are not People, Organisations, Locations or Events, are captured. The 5 Tables interconnect through a series of <code class="prettyprint">cross-reference Tables</code>, where an Event can link to several People, Organisations, Locations, and Things and a Person can link to several Events, Organisations, Locations, and Things, and so on. This is flexible system that will allow users to fully model their existing data sets. For example, someone could model a meeting they had in Meeting Space 2 as a connection between an Event with a start time and an end time, the individuals involved as People, and Meeting Space 2 itself as a Location.</p>

<p><img title="Contextualisation" alt="Contextualisation" src="images/contextualisation.png" /></p>

<p>The 5 contextualised <code class="prettyprint">Tables</code> link to the <code class="prettyprint">Raw Data</code> itself through a series of <code class="prettyprint">Properties</code>. The schema will host a number of user-defined Properties that may link to several <code class="prettyprint">Records</code> of the 5 Tables. For example, a user may have “First Name” and “Last Name” as Properties within the schema, that when linked through a Person Record (through a cross-reference Table) would point to separate <code class="prettyprint">Values</code> stored within the <code class="prettyprint">Raw Data</code> structure. To emphasise flexibility, Properties can point to any of: Values, Fields, Records or Tables. For example, a user may wish to model their heart rate as a set of all Records within a Table (by establishing a relationship between the “Heart Rate” Property and a Table”), but may also wish to model their heart rate as a set of all Fields within a Table (by establishing the relationship with a Field) if they import generic health data as a single Table.</p>

<aside class="notice">
Contextualisation APIs - all Data, Entities (People, Things, Events, Locations and Organisations) and each of their Properties should be tagged with Types and Units of Measurement when applicable.
</aside>

<h2 id="entities">Entities</h2>

<p>The HAT enables to transform previously collected data into 5 Entities: Person  (Who), Thing (What), Event  (When),  Location  (Where),  and  Organisation  (Where/with Whom),  so  that  users  can  describe  how  they  live  –  When  and  Where  an  Event  took  place,  What  things  and  Data  are  involved  with  Who  (and  potentially Why).</p>

<h3 id="entity-structure">Entity Structure</h3>

<p>All Entities (People, Things, Events, Locations and Organisations) contain all the information defined in Entity Structure. If you want to create a new Entity, you have to include mandatory information in the API request. Entity structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>entity ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the entity</td>
<td>mandatory</td>
</tr>
<tr>
<td>staticProperties</td>
<td>list of properties that are linked with the entity statically</td>
<td>optional</td>
</tr>
<tr>
<td>dynamicProperties</td>
<td>list of properties that are linked with the entity dynamically</td>
<td>optional</td>
</tr>
<tr>
<td>events</td>
<td>list of events that are linked with the entity</td>
<td>optional</td>
</tr>
<tr>
<td>locations</td>
<td>list of locations that are linked with the entity</td>
<td>optional</td>
</tr>
<tr>
<td>people</td>
<td>list of people that are linked with the entity</td>
<td>optional</td>
</tr>
<tr>
<td>things</td>
<td>list of things that are linked with the entity</td>
<td>optional</td>
</tr>
<tr>
<td>organisations</td>
<td>list of organisations that are linked with the entity</td>
<td>optional</td>
</tr>
</tbody></table>

<h3 id="creating-an-entity">Creating an Entity</h3>

<p>You should create a new Entity, implemented in each endpoint, separately for every set of Values you want to be treated as a specific Entity record. For example, you might want to create an Entity as an Event or as a Person. To create a new <code class="prettyprint">Entity</code> as an Event, the API request body should contain a new Entity <code class="prettyprint">name</code> and it should be posted to <code class="prettyprint">/event</code> endpoint. Similarly, you can create new Entities as a <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Location</code> or <code class="prettyprint">Organisation</code> by posting your API request to a relevant endpoint. The new Entity ID will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of creating a new entity as an event:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
     "name": "birthdayParty"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/event"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/event</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
  "name": "birthdayParty"
}
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 1,
  <span class="s2">"name"</span>: <span class="s2">"birthdayParty"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"birthdayParty"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="listing-available-entities">Listing Available Entities</h3>

<p>You might want to check what Entities have been already created for a specific category (e.g. Person) before defining a new one. To list all available Entities for a specific category, you should make a GET request to <code class="prettyprint">/entity</code> endpoint, where Entity can be a <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Event</code>, <code class="prettyprint">Location</code> or <code class="prettyprint">Organisation</code> . The response of each Entity will contain minimal structure, i.e. it will not contain information about linked Entities and Properties.</p>

<blockquote>
<p>Example of listing all available person entities:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/person"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/person</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"id"</span>: 1,
    <span class="s2">"name"</span>: <span class="s2">"Me"</span>,
    <span class="s2">"personId"</span>: <span class="s2">"demo.hat.org"</span>
  <span class="o">}</span>,
  <span class="o">{</span>
    <span class="s2">"id"</span>: 4,
    <span class="s2">"name"</span>: <span class="s2">"Spouse"</span>,
    <span class="s2">"personId"</span>: <span class="s2">"spouse.hat.org"</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Me"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"personId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo.hat.org"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Spouse"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"personId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spouse.hat.org"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre>

<h3 id="filtering-entities">Filtering Entities</h3>

<p>You might need to extract some information about a particular Entity, e.g. it&rsquo;s ID. You can retrieve information about that Entity using a GET request and specifying ID of that Entity. For example, to find the Event with ID = 1, include its ID in the URL and post it to <code class="prettyprint">/event/1</code> endpoint. Similarly, you can retrieve information about <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Location</code> or <code class="prettyprint">Organisation</code> Entities by posting your API request to a relevant endpoint and specifying ID of the Entity of interest. </p>

<blockquote>
<p>Example of finding a particular event entity by ID:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/event/EVENT_ID"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/event/EVENT_ID</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>EVENT_ID must be replaced with the ID of the Event you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 1,
  <span class="s2">"name"</span>: <span class="s2">"birthdayParty"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"birthdayParty"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="retrieving-complete-entity-structure">Retrieving Complete Entity Structure</h3>

<p>Sometimes you might want to extract all information in Entity structure. You can retrieve a full Entity Structure (including linked Properties and Entities) by specifying <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Event</code>, <code class="prettyprint">Location</code> or <code class="prettyprint">Organisation</code> Entity ID and making a GET request to a relevant endpoint. For instance, to extract information about a Thing with ID = 3, you need to make a GET request to <code class="prettyprint">thing/3/values</code>.</p>

<blockquote>
<p>Example of extracting a particular entity information:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/thing/THING_ID/values"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/thing/THING_ID/values</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>THING_ID must be replaced with the ID of the Thing you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"id"</span>: 3,
    <span class="s2">"name"</span>: <span class="s2">"Phone"</span>,
    <span class="s2">"people"</span>: 
    <span class="o">[</span>
      <span class="o">{</span>
        <span class="s2">"relationshipType"</span>: <span class="s2">"owns"</span>,
        <span class="s2">"person"</span>: 
        <span class="o">{</span>
          <span class="s2">"id"</span>: 1,
          <span class="s2">"name"</span>: <span class="s2">"Me"</span>,
          <span class="s2">"personId"</span>: <span class="s2">"demo.hat.org"</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">]</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"people"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"relationshipType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"owns"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"person"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Me"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"personId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"demo.hat.org"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<h3 id="creating-links-between-entities">Creating links between Entities</h3>

<p>It is useful to link various Entities. For example, you might want to link the Event &ldquo;birthdayParty&rdquo; with ID = 1 to the <code class="prettyprint">Person</code> &ldquo;Spouse&rdquo; with ID = 4. This can be done by creating an API request body containing your defined <code class="prettyprint">relationship Type</code> name (e.g. &ldquo;attends&rdquo;) and typing <code class="prettyprint">/event/1/person/4</code> in the POST request to link <code class="prettyprint">Event</code> with ID = 1 to <code class="prettyprint">Person</code> with ID = 4. Similarly, different Entity categories can be linked. In general, you need to post your API request to <code class="prettyprint">/entity/ENTITY_ID/entity/ENTITY_ID</code> to link Entities from <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Event</code>, <code class="prettyprint">Location</code>, <code class="prettyprint">Organisation</code> categories. However, it is important to note that not all the Entities can be linked. From the table below we can see that, for example, Event can be linked to Person, but Person cannot be linked to Event. In other words, you can have <code class="prettyprint">/event/EVENT_ID/person/PERSON_ID</code>, but you <code class="prettyprint">cannot</code> have <code class="prettyprint">/person/PERSON_ID/event/EVENT_ID</code>. The new Relationship ID will be recorded automatically and included in the response.</p>

<p>It is important to note that linking <code class="prettyprint">Person</code> to <code class="prettyprint">Person</code> is slightly different. In this case, <code class="prettyprint">relationship Type</code> has to be created before linking and in addition to its name, its ID should be included in the POST request. For details how to create and list all available <code class="prettyprint">Person Relationship Types</code> see the following two section.  </p>

<table><thead>
<tr>
<th>Entity</th>
<th>Can be linked to Entities</th>
</tr>
</thead><tbody>
<tr>
<td>person</td>
<td>person, location, organisation</td>
</tr>
<tr>
<td>thing</td>
<td>thing, person</td>
</tr>
<tr>
<td>event</td>
<td>event, location, organisation, person, thing</td>
</tr>
<tr>
<td>location</td>
<td>location, thing</td>
</tr>
<tr>
<td>organisation</td>
<td>organisation, location</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of linking Event to Person:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
     "relationshipType": "attends"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/event/EVENT_ID/person/PERSON_ID"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/event/EVENT_ID/person/PERSON_ID</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
  "relationshipType": "attends"
}
</code></pre>

<blockquote>
<p>EVENT_ID and PERSON_ID must be replaced with the IDs of Entities you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 1
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="creating-person-relationship-types">Creating Person Relationship Types</h3>

<p>All Person Relationship Type API calls contain all the information defined in its Structure. If you want to create a new Person Relationship Type, you have to include all the mandatory information in the API request. Person Relationship Type structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>person relationship type ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the relationship type</td>
<td>mandatory</td>
</tr>
<tr>
<td>description</td>
<td>description of the relationship type</td>
<td>optional</td>
</tr>
</tbody></table>

<p>Therefore, to create a new <code class="prettyprint">Person Relationship Type</code>, the API request body should contain a new Person Relationship Type <code class="prettyprint">name</code> and it should be posted to <code class="prettyprint">/person/relationshipType</code> endpoint. The new Person Relationship Type ID will be recorded automatically and included in the response. </p>

<blockquote>
<p>Example of creating a Person Relationship Type:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
       "name":"friend"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/person/relationshipType"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/person/relationshipType</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
    "name":"friend"
}
</code></pre>

<blockquote>
<p>EVENT_ID and PERSON_ID must be replaced with the IDs of Entities you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 6,
  <span class="s2">"name"</span>: <span class="s2">"friend"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"friend"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="listing-available-person-relationship-types">Listing Available Person Relationship Types</h3>

<p>You might want to check what Person Relationship Types have been already created before defining a new one. To list all available Person Relationship Types, you should make a GET request to <code class="prettyprint">/person/relationshipType</code> endpoint. The response will contain a list of Person Relationship Types with their IDs.  </p>

<blockquote>
<p>Example of listing all available Person Relationship Types:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/person/relationshipType"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/person/relationshipType</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
  <span class="o">{</span>
    <span class="s2">"id"</span>: 3,
    <span class="s2">"name"</span>: <span class="s2">"coach"</span>,
    <span class="s2">"description"</span>: <span class="s2">"A person that acts in a coaching role for a sports team."</span>
  <span class="o">}</span>,
  <span class="o">{</span>
    <span class="s2">"id"</span>: 4,
    <span class="s2">"name"</span>: <span class="s2">"colleague"</span>,
    <span class="s2">"description"</span>: <span class="s2">"A colleague of the person"</span>
  <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"coach"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A person that acts in a coaching role for a sports team."</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"colleague"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A colleague of the person"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<h3 id="adding-type-to-existing-entity">Adding Type to Existing Entity</h3>

<p>Sometimes you might need to add a <code class="prettyprint">Type</code> to an existing <code class="prettyprint">Entity</code>. For example, you might want your <code class="prettyprint">Event</code> Entity &ldquo;birthdayParty&rdquo; (ID = 1) contain Type &ldquo;Date&rdquo; (ID = 2). To add the <code class="prettyprint">Type</code> to the existing Entity, the API request body should contain <code class="prettyprint">relationship Type</code> name (e.g. &ldquo;date&rdquo;) and it should be posted to <code class="prettyprint">/event/1/type/2</code> endpoint. In general, you need to post your API request to <code class="prettyprint">/entity/ENTITY_ID/type/TYPE_ID/</code> to add Types to any of the Entities from <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Event</code>, <code class="prettyprint">Location</code>, <code class="prettyprint">Organisation</code> categories. The new Relationship ID will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of adding Type to Event Entity:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
     "relationshipType": "date"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/event/EVENT_ID/type/TYPE_ID"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/event/EVENT_ID/type/TYPE_ID</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
  "relationshipType": "date"
}
</code></pre>

<blockquote>
<p>EVENT_ID and TYPE_ID must be replaced with the IDs of Entity and Type you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 1
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="linking-entities-to-properties-statically">Linking Entities to Properties Statically</h3>

<p>In order to link <code class="prettyprint">Entity</code> to <code class="prettyprint">Property</code> statically, you need to specify a single Field and Record ID to which the Entity should be linked to. This means that Entity linked to Property statically is linked to particular Data Value. For example, to link the <code class="prettyprint">Person</code> &ldquo;Me&rdquo; (ID = 1) to the <code class="prettyprint">Record</code> &ldquo;Day 1&rdquo; (ID = 8), which is in the <code class="prettyprint">Field</code> &ldquo;Weight&rdquo; (ID = 50), which is associated to the <code class="prettyprint">Property</code> &ldquo;bodyWeight&rdquo; (ID = 1), you need to create an API request body containing Property, its Type and Unit of Measurement, Field and Record <code class="prettyprint">names</code> and <code class="prettyprint">IDs</code>, and type <code class="prettyprint">/person/1/property/static/1</code> in the POST request. Similarly, all the different Entity categories can be linked to particular Properties. In general, you need to post your API request to <code class="prettyprint">/entity/ENTITY_ID/property/static/PROPERTY_ID</code> to link any of the Entities from <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Event</code>, <code class="prettyprint">Location</code>, <code class="prettyprint">Organisation</code> categories to particular Properties. The new Static Relationship ID will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of linking Person Entity to Property statically:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
     "property": 
     {
       "id": 1,
       "name": "bodyWeight",
       "propertyType": 
       {
         "name": "weight",
         "id": 19
       },
       "unitOfMeasurement": 
       {
         "name": "kilograms",
         "id": 1
       }
     },
     "relationshipType": "weight",
     "field": 
     {
       "id": 50,
       "name": "Weight"
     },
     "record": 
     {
       "id": 8,
       "name": "Day 1"
     }
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/person/PERSON_ID/property/static/PROPERTY_ID"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/person/PERSON_ID/property/static/PROPERTY_ID</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
  "property": 
  {
    "id": 1,
    "name": "bodyWeight",
    "propertyType": 
    {
      "name": "weight",
      "id": 19
    },
    "unitOfMeasurement": 
    {
      "name": "kilograms",
      "id": 1
    }
  },
  "relationshipType": "weight",
  "field": 
  {
    "id": 50,
    "name": "Weight"
  },
  "record": 
  {
    "id": 8,
    "name": "Day 1"
  }
}
</code></pre>

<blockquote>
<p>PERSON_ID and PROPERTY_ID must be replaced with the IDs of Entity and Property you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 1
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="linking-entities-to-properties-dynamically">Linking Entities to Properties Dynamically</h3>

<p>In contrast to linking Entities to Properties statically, to link them dynamically you do not need to specify Record ID. This means that Entity linked to Property dynamically is not linked to particular Data Value and is linked to the whole Field instead. For example, to link the <code class="prettyprint">Person</code> &ldquo;Me&rdquo; (ID = 1) to the <code class="prettyprint">Field</code> &ldquo;Weight&rdquo; (ID = 50), which is associated to the <code class="prettyprint">Property</code> &ldquo;bodyWeight&rdquo; (ID = 1), you need to create an API request body containing Property, its Type and Unit of Measurement, and Field <code class="prettyprint">names</code> and <code class="prettyprint">IDs</code>, and type <code class="prettyprint">/person/1/property/dynamic/1</code> in the POST request. Similarly, all the different Entity categories can be linked to particular Properties. In general, you need to post your API request to <code class="prettyprint">/entity/ENTITY_ID/property/dynamic/PROPERTY_ID</code> to link any of the Entities from <code class="prettyprint">Person</code>, <code class="prettyprint">Thing</code>, <code class="prettyprint">Event</code>, <code class="prettyprint">Location</code>, <code class="prettyprint">Organisation</code> categories to particular Properties. The new Dynamic Relationship ID will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of linking Person Entity to Property dynamically:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
     "property": 
     {
       "id": 1,
       "name": "bodyWeight",
       "propertyType": 
       {
         "name": "weight",
         "id": 19
       },
       "unitOfMeasurement": 
       {
         "name": "kilograms",
         "id": 1
       }
     },
     "relationshipType": "weight",
     "field": 
     {
       "id": 50,
       "name": "Weight"
     }
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/person/PERSON_ID/property/static/PROPERTY_ID"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/person/PERSON_ID/property/static/PROPERTY_ID</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
  "property": 
  {
    "id": 1,
    "name": "bodyWeight",
    "propertyType": 
    {
      "name": "weight",
      "id": 19
    },
    "unitOfMeasurement": 
    {
      "name": "kilograms",
      "id": 1
    }
  },
  "relationshipType": "weight",
  "field": 
  {
    "id": 50,
    "name": "Weight"
  }
}
</code></pre>

<blockquote>
<p>PERSON_ID and PROPERTY_ID must be replaced with the IDs of Entity and Property you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 9
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h1 id="data-type-annotations">Data Type Annotations</h1>

<h2 id="system-properties">System Properties</h2>

<p>The collected data can be transformed into Thing, Person, Location, Event and Organisation and each of these can have their Properties. For example, a Person can have various properties, including: &ldquo;First Name&rdquo; with the Unit of Measurement &ldquo;none&rdquo; (no unit of measurement) and &ldquo;Weight&rdquo; with the Unit of Measurement &ldquo;kilograms&rdquo;. Each property is therefore a Collection of data (e.g. collection of first names). A default set of Properties, common across all HATs, is provided by HATDeX, however they can be further customised by HAT developers.</p>

<h3 id="property-structure">Property Structure</h3>

<p>All Property API calls contain all the information defined in Property Structure. If you want to create a new Property, you have to include all the mandatory information in the API request. Property structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>property ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the property was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the property was updated</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the property</td>
<td>mandatory</td>
</tr>
<tr>
<td>description</td>
<td>description of the property</td>
<td>optional</td>
</tr>
<tr>
<td>propertyType</td>
<td>type of the property</td>
<td>mandatory</td>
</tr>
<tr>
<td>unitOfMeasurement</td>
<td>unit of measurement of the property</td>
<td>mandatory</td>
</tr>
</tbody></table>

<h3 id="creating-a-property">Creating a Property</h3>

<p>You should create a new Property for every set of Values you want to be treated as a specific Property record. For example, you might want to have properties &ldquo;First Name&rdquo; and &ldquo;Last Name&rdquo;, or you might want to create a property &ldquo;Full Name&rdquo;. It is important to note that a <code class="prettyprint">Property</code> can have a <code class="prettyprint">Type</code> and <code class="prettyprint">Unit of Measurement</code> associated with it. For example, a property &ldquo;bodyWeight&rdquo; would be of Type &ldquo;weight&rdquo; and would have Unit of Measurement &ldquo;kilograms&rdquo;. To create a new <code class="prettyprint">Property</code>, the API request body should contain a new Property <code class="prettyprint">name</code>, its <code class="prettyprint">Type</code> and <code class="prettyprint">Unit of Measurement</code>, and it should be posted to <code class="prettyprint">/property</code> endpoint. Note that in order to relate a particular Type and Unit of Measurement to a new Property, their names, descriptions and IDs should be included in the API request body. The new Property ID and times when it was created as well as updated will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of creating a new Property:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
      "name": "bodyWeight",
      "description": "body weight of a person",
      "propertyType": 
      {
          "name": "weight",
          "id": 19
      },
      "unitOfMeasurement": 
      {
         "name": "kilograms",
         "id": 1
      }
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/property"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/property</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
    "name": "bodyWeight",
    "description": "body weight of a person",
    "propertyType": 
    {
       "name": "weight",
       "id": 19
    },
    "unitOfMeasurement": 
    {
        "name": "kilograms",
        "id": 1
    }
}
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"bodyWeight"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-21T21:55:36Z"</span>,
    <span class="s2">"description"</span>: <span class="s2">"body weight of a person"</span>,
    <span class="s2">"propertyType"</span>: 
    <span class="o">{</span>
        <span class="s2">"id"</span>: 19,
        <span class="s2">"name"</span>: <span class="s2">"weight"</span>,
    <span class="o">}</span>,
    <span class="s2">"id"</span>: 6,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-21T21:55:36Z"</span>,
    <span class="s2">"unitOfMeasurement"</span>: 
    <span class="o">{</span>
        <span class="s2">"id"</span>: 1,
        <span class="s2">"name"</span>: <span class="s2">"kilograms"</span>,
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bodyWeight"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-21T21:55:36Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"body weight of a person"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"propertyType"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weight"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"weight of a person"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-21T21:55:36Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"unitOfMeasurement"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kilograms"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"measurement of weight"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="listing-available-properties">Listing Available Properties</h3>

<p>You might want to check what Properties have been already created before defining a new one. To list all available Properties, you should make a GET request to <code class="prettyprint">/property</code> endpoint. The response of each Property will contain some additional information, i.e. its ID and times when it was created as well as updated.   </p>

<blockquote>
<p>Example of listing all available Properties:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/property"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/property</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"bodyWeight"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Body weight of a person"</span>,
        <span class="s2">"propertyType"</span>: 
        <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"QuantitativeValue"</span>,
            <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
            <span class="s2">"description"</span>: <span class="s2">"A quantitative (numerical) value"</span>,
            <span class="s2">"id"</span>: 12,
            <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
        <span class="o">}</span>,
        <span class="s2">"id"</span>: 1,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"unitOfMeasurement"</span>: 
        <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"kilograms"</span>,
            <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
            <span class="s2">"description"</span>: <span class="s2">"measurement of weight"</span>,
            <span class="s2">"symbol"</span>: <span class="s2">"kg"</span>,
            <span class="s2">"id"</span>: 1,
            <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
        <span class="o">}</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"name"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Name"</span>,
        <span class="s2">"propertyType"</span>: 
        <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"Text"</span>,
            <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
            <span class="s2">"description"</span>: <span class="s2">"A generic textual value"</span>,
            <span class="s2">"id"</span>: 13,
            <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
        <span class="o">}</span>,
        <span class="s2">"id"</span>: 2,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"unitOfMeasurement"</span>: 
        <span class="o">{</span>
            <span class="s2">"name"</span>: <span class="s2">"none"</span>,
            <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
            <span class="s2">"description"</span>: <span class="s2">"no unit of measurement (plain text)"</span>,
            <span class="s2">"id"</span>: 3,
            <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bodyWeight"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Body weight of a person"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"propertyType"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"QuantitativeValue"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A quantitative (numerical) value"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"unitOfMeasurement"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kilograms"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"measurement of weight"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kg"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Name"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"propertyType"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Text"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A generic textual value"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"unitOfMeasurement"</span><span class="p">:</span><span class="w"> 
        </span><span class="p">{</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"none"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no unit of measurement (plain text)"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">

</span></code></pre>

<h3 id="filtering-properties">Filtering Properties</h3>

<p>You might need to extract some information about a particular Property, e.g. its ID in the system. You can retrieve information about that Property using a GET request and specifying name of that Property. For example, to find the Property named “height”, include the parameter <code class="prettyprint">name=height</code> in the URL.</p>

<blockquote>
<p>Example of finding a particular Property by name:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/property?name=height"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/property?name=height</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"height"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
    <span class="s2">"description"</span>: <span class="s2">"Body height of a person"</span>,
    <span class="s2">"propertyType"</span>: 
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"QuantitativeValue"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"A quantitative (numerical) value"</span>,
        <span class="s2">"id"</span>: 12,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
    <span class="o">}</span>,
    <span class="s2">"id"</span>: 3,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
    <span class="s2">"unitOfMeasurement"</span>: 
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"centimeters"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"measurement of height or length"</span>,
        <span class="s2">"symbol"</span>: <span class="s2">"cm"</span>,
        <span class="s2">"id"</span>: 4,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"height"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Body height of a person"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"propertyType"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"QuantitativeValue"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A quantitative (numerical) value"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"unitOfMeasurement"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"centimeters"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"measurement of height or length"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cm"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="system-data-types">System Data Types</h2>

<p>Each contextualised data item is linked with its Type. The HAT defines a set of Types that can be used to annotate entities and data. For example, type &ldquo;PostalAddress&rdquo; is used to annotate physical address of item. A default set of Types, common across all HATs, is provided by HATDeX, however Types can be further customised by HAT developers.</p>

<h3 id="type-structure">Type Structure</h3>

<p>All Type API calls contain all the information defined in Type Structure. If you want to create a new Type, you have to include all the mandatory information in the API request. Type structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>type ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the type was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the type was updated</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the type</td>
<td>mandatory</td>
</tr>
<tr>
<td>description</td>
<td>description of the type</td>
<td>optional</td>
</tr>
</tbody></table>

<h3 id="creating-a-type">Creating a Type</h3>

<p>You should create a new Type for every set of Values you want to be treated as a specific Type record. For example, you might want to have a Type &ldquo;Country&rdquo; to annotate your country of birth, or you might want it to annotate all the countries you have ever lived in. To create a new <code class="prettyprint">Type</code>, the API request body should contain a new Type <code class="prettyprint">name</code> and it should be posted to <code class="prettyprint">/type/type</code> endpoint. The new Type ID and times when it was created as well as updated will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of creating a new Data Type:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
      "name": "Date",
      "description": "Date in time"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/type/type"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/type/type</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
    "name": "Date",
    "description": "Date in time"
}
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"Date"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-17T21:01:59Z"</span>,
    <span class="s2">"description"</span>: <span class="s2">"Date in time"</span>,
    <span class="s2">"id"</span>: 4,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-17T21:01:59Z"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Date"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-17T21:01:59Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Date in time"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-17T21:01:59Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="creating-links-between-types">Creating links between Types</h3>

<p>It is useful to link various Types. For example, you might have types &ldquo;address&rdquo; (ID = 1), &ldquo;place&rdquo; (ID = 2) and &ldquo;PostalAddress&rdquo; (ID = 3), where you want &ldquo;place&rdquo; and &ldquo;PostalAddress&rdquo; to be treated as <code class="prettyprint">subTypes</code> of type &ldquo;address&rdquo;. To create such Type hierarchy, you need to link &ldquo;address&rdquo; to &ldquo;place&rdquo; and &ldquo;address&rdquo; to &ldquo;PostalAddress&rdquo; by defining a <code class="prettyprint">relationship Type</code>. This can be done by creating an API request body containing <code class="prettyprint">relationshipType</code> name (e.g. &ldquo;subtype&rdquo;) and typing <code class="prettyprint">/type/1/type/2</code> and <code class="prettyprint">/type/1/type/3</code> in the POST request to link &ldquo;address&rdquo; to &ldquo;place&rdquo; and &ldquo;address&rdquo; to &ldquo;PostalAddress&rdquo; respectively. Relationship IDs will be created automatically.</p>

<blockquote>
<p>Example of creating a link between two Types:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
      "relationshipType": "subtype"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/type/ID_1/type/ID_2"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/type/ID_1/type/ID_2</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
    "relationshipType": "subtype"
}
</code></pre>

<blockquote>
<p>ID_1 and ID_2 must be replaced with the IDs of Types you want</p>

<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"id"</span>: 1
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="listing-available-types">Listing Available Types</h3>

<p>You might want to check what Types have been already created before defining a new one. To list all available Types, you should make a GET request to <code class="prettyprint">/type/type</code> endpoint. The response of each Type will contain some additional information, i.e. its ID and times when it was created as well as updated.                           </p>

<blockquote>
<p>Example of listing all available Types:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/type/type"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/type/type</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"Country"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Nationality of the person"</span>,
        <span class="s2">"id"</span>: 1,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"Date"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"Date of birth"</span>,
        <span class="s2">"id"</span>: 2,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Country"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nationality of the person"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Date"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Date of birth"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<h3 id="filtering-types">Filtering Types</h3>

<p>You might need to extract some information about a particular Type, e.g. its ID in the system. You can retrieve information about that Type using a GET request and specifying name of that Type. For example, to find the Type named “PostalAddress”, include the parameter <code class="prettyprint">name=PostalAddress</code> in the URL.</p>

<blockquote>
<p>Example of finding a particular Type by name:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/type/type?name=PostalAddress"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/type/type?name=PostalAddress</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"PostalAddress"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
    <span class="s2">"description"</span>: <span class="s2">"Physical address of the item"</span>,
    <span class="s2">"id"</span>: 10,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PostalAddress"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Physical address of the item"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="system-units-of-measurement">System Units of Measurement</h2>

<p>Each contextualised data property is associated with its Units of Measurement. The HAT defines a set of Units of Measurement that can be used. For example, a Unit of Measurement &ldquo;kilograms&rdquo; was set. A default set of Units of Measurement, common across all HATs, is provided by HATDeX, however Units of Measurement can be further customised by HAT developers.</p>

<h3 id="unit-of-measurement-structure">Unit of Measurement Structure</h3>

<p>All Unit of Measurement API calls contain all the information defined in Unit of Measurement Structure. If you want to create a new Unit of Measurement, you have to include all the mandatory information in the API request. Unit of Measurement structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>unit of measurement ID in the system</td>
<td>optional</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the unit of measurement  was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the unit of measurement  was updated</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the unit of measurement</td>
<td>mandatory</td>
</tr>
<tr>
<td>description</td>
<td>description of the unit of measurement</td>
<td>optional</td>
</tr>
<tr>
<td>symbol</td>
<td>symbol of the unit of measurement</td>
<td>optional</td>
</tr>
</tbody></table>

<h3 id="creating-a-unit-of-measurement">Creating a Unit of Measurement</h3>

<p>You should create a new <code class="prettyprint">Unit of Measurement</code> for every set of Values you want to be associated with that Unit of Measurement. For example, you might want to have &ldquo;kilograms&rdquo; and &ldquo;grams&rdquo; for weight Units of Measurement. To create a new <code class="prettyprint">Unit of Measurement</code>, the API request body should contain its <code class="prettyprint">name</code> and it should be posted to <code class="prettyprint">/type/unitofmeasurement</code> endpoint. The new Unit of Measurement ID and times when it was created as well as updated will be recorded automatically and included in the response.</p>

<blockquote>
<p>Example of creating a new Unit of Measurement:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\</span>
  <span class="s1">'{
      "name": "kilograms",
      "description": "measurement of weight",
      "symbol": "kg"
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/type/unitofmeasurement"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/type/unitofmeasurement</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>

{
    "name": "kilograms",
    "description": "measurement of weight",
    "symbol": "kg"
}
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"id"</span>: 1,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-10-13T18:10:42+01:00"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-10-13T18:10:42+01:00"</span>,
    <span class="s2">"name"</span>: <span class="s2">"kilograms"</span>,
    <span class="s2">"description"</span>: <span class="s2">"measurement of weight"</span>,
    <span class="s2">"symbol"</span>: <span class="s2">"kg"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-13T18:10:42+01:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-13T18:10:42+01:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kilograms"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"measurement of weight"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kg"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<h3 id="listing-available-units-of-measurement">Listing Available Units of Measurement</h3>

<p>You might want to check what Units of Measurement have been already created before defining a new one. To list all available Units of Measurement, you should make a GET request to <code class="prettyprint">/type/unitofmeasurement</code> endpoint. The response of each Unit of Measurement will contain some additional information, i.e. its ID and times when it was created as well as updated.                                                                                                                                                                                                   </p>

<blockquote>
<p>Example of listing all available Units of Measurement:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/type/unitofmeasurement"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/type/unitofmeasurement</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"kilograms"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"measurement of weight"</span>,
        <span class="s2">"symbol"</span>: <span class="s2">"kg"</span>,
        <span class="s2">"id"</span>: 1,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">"name"</span>: <span class="s2">"meters"</span>,
        <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
        <span class="s2">"description"</span>: <span class="s2">"measurement of height or length"</span>,
        <span class="s2">"symbol"</span>: <span class="s2">"m"</span>,
        <span class="s2">"id"</span>: 2,
        <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kilograms"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"measurement of weight"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kg"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"meters"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"measurement of height or length"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<h3 id="filtering-units-of-measurement">Filtering Units of Measurement</h3>

<p>You might need to extract some information about a particular Unit of Measurement, e.g. its symbol. You can retrieve information about that Unit of Measurement using GET and specifying name of that Unit of Measurement. For example, to find the Unit of Measurement named &ldquo;meters&rdquo;, include the parameter <code class="prettyprint">name=meters</code> in the URL.</p>

<blockquote>
<p>Example of finding a particular Unit of Measurement by name:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/type/unitofmeasurement?name=meters"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/type/unitofmeasurement?name=meters</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">MyClient/1.0.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
    <span class="s2">"name"</span>: <span class="s2">"meters"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>,
    <span class="s2">"description"</span>: <span class="s2">"measurement of height or length"</span>,
    <span class="s2">"symbol"</span>: <span class="s2">"m"</span>,
    <span class="s2">"id"</span>: 2,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-11-04T02:50:47Z"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"meters"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"measurement of height or length"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"symbol"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-11-04T02:50:47Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h1 id="data-bundling">Data Bundling</h1>

<h2 id="contextual-bundling">Contextual Bundling</h2>

<p><img title="Contextual Bundling" alt="Contextual Bundling" src="images/contextualBundles.png" /></p>

<p>Bundles of <em>contextual</em> data are sets of entities (people, things, events, locations and organisations) and their properties that a HAT owner has chosen to combine together for potentially sharing with others.</p>

<p>As such, a <em>contextual bundle</em> consists of a number of <em>selectors</em> that help people and application developers specify such sets of data with varying degrees of flexibility.</p>

<p>An <em>entity selector</em> finds all entities according to three parameters:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>entityId</td>
<td>specific ID of the entity, no other entities will be included</td>
<td>optional</td>
</tr>
<tr>
<td>entityName</td>
<td>name of all entities to be included</td>
<td>optional</td>
</tr>
<tr>
<td>entityKind</td>
<td>kind of all entities to be included</td>
<td>optional</td>
</tr>
</tbody></table>

<p>The most general <em>entity selector</em> therefore only specifies <code class="prettyprint">entityKind</code>, such as <code class="prettyprint">person</code>, returning all people in the database. However, the privacy-conscious HAT owner is very unlikely to share all of this data with an application developer.</p>

<p>Inside each <em>entity selector</em> there may also be a list of <em>property selectors</em> which specify which properties to include for the bundled entity. If <em>property selectors</em> are not specified, all properties are included.</p>

<p>A <em>property selector</em> can similarly have a number of parameters:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>propertyRelationshipKind</td>
<td>kind of property (<code class="prettyprint">static</code>/<code class="prettyprint">dynamic</code>) to include (any if not specified)</td>
<td>optional</td>
</tr>
<tr>
<td>propertyName</td>
<td>name of the property (e.g. <code class="prettyprint">Body Weight</code>)</td>
<td>optional</td>
</tr>
<tr>
<td>propertyType</td>
<td>type of a property, such as <code class="prettyprint">text</code>, <code class="prettyprint">quantitative value</code> or a more specific <code class="prettyprint">weight</code></td>
<td>optional</td>
</tr>
<tr>
<td>propertyUnitofmeasurement</td>
<td>name of the unit of measurement of interest</td>
<td>optional</td>
</tr>
</tbody></table>

<aside class="warning">
You can use `/bundles/context/` set of API endpoints to manage and view bundles, however they are only authorized for the `owner`! If you are an application developer, you should use the Direct Data Debits set of APIs and include your Bundle configuration directly in your D3 proposal.
</aside>

<p>The set of available API endpoints for managing bundles is:
- <code class="prettyprint">POST</code> to <code class="prettyprint">bundles/context</code> creates a new bundle
- <code class="prettyprint">GET</code> from <code class="prettyprint">bundle/context/BUNDLE_ID</code> retrieves the bundle structure
- <code class="prettyprint">GET</code> from <code class="prettyprint">bundle/context/BUNDLE_ID/values</code> retrieves the bundled entities with their properties and values
- <code class="prettyprint">POST</code> to <code class="prettyprint">bundles/context/BUNDLE_ID/entitySelection</code> adds a new entity selection to an already existing bundle
- <code class="prettyprint">POST</code> to <code class="prettyprint">bundles/context/BUNDLE_ID/entitySelection/SELECTION_ID/propertySelection</code> adds a new property selection to an already existing entity selection within a bundle</p>

<blockquote>
<p>Example of creating a new Contextual Bundle:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'{
    "name": "emptyBundleTest5-1",
    "entities": 
    [
     {
       "entityKind": "person",
       "properties": 
       [
         {
           "propertyRelationshipKind": "dynamic",
           "propertyName": "BodyWeight"
         },
         {
           "propertyRelationshipKind": "dynamic",
           "propertyType": "QuantitativeValue"
         }
       ]
     },
     {
       "entityName": "sunrise"
     }
    ]
  }'</span><span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/bundles/context</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"emptyBundleTest5-1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"entities"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">[</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="nt">"entityKind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"person"</span><span class="p">,</span><span class="w">
     </span><span class="nt">"properties"</span><span class="p">:</span><span class="w"> 
     </span><span class="p">[</span><span class="w">
       </span><span class="p">{</span><span class="w">
         </span><span class="nt">"propertyRelationshipKind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dynamic"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"propertyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BodyWeight"</span><span class="w">
       </span><span class="p">},</span><span class="w">
       </span><span class="p">{</span><span class="w">
         </span><span class="nt">"propertyRelationshipKind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dynamic"</span><span class="p">,</span><span class="w">
         </span><span class="nt">"propertyType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"QuantitativeValue"</span><span class="w">
       </span><span class="p">}</span><span class="w">
     </span><span class="p">]</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="nt">"entityName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sunrise"</span><span class="w">
   </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h2 id="contextless-bundling">Contextless Bundling</h2>

<p><img title="Contextless Bundling" alt="Contextless Bundling" src="images/contextlessBundles.png" /></p>

<blockquote>
<p>Example of creating a new Contextless Bundle:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'{
     "name": "emptyBundle",
     "bundleTable": 
     [
       {
         "name": "Everything kitchen",
         "table": 
         {
           "id": 2,
           "name": "kitchen",
           "source": "fibaro"
         }
       }
     ]
   }'</span><span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/bundles/contextless?name=meters"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/bundles/contextless</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"emptyBundle"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bundleTable"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Everything kitchen"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"table"</span><span class="p">:</span><span class="w"> 
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchen"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"id"</span>: 4,
  <span class="s2">"dateCreated"</span>: <span class="s2">"2015-12-04T21:18:23Z"</span>,
  <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-12-04T21:18:23Z"</span>,
  <span class="s2">"name"</span>: <span class="s2">"emptyBundle"</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T21:18:23Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T21:18:23Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"emptyBundle"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h1 id="sharing-and-direct-data-debits">Sharing and Direct Data Debits</h1>

<p>The virtualised database (or “Raw Data”) allows users to export the Data, where (potentially) separate Tables are created to match the expected Data format that an API consuming service expects. For example, if a user has cross-referenced the films they have “Liked” on Facebook to their viewing history on Netflix, then a service which wants to consume this data may expect a Table containing films that the user has Liked with a total number of times they have watched the film. To simplify this for the first phase, it is assumed that a service consuming the PDS API will be able to read the data held within the contextualised tables, and format the data appropriately within the virtualised database.</p>

<p>The HAT&rsquo;s Direct Data Debit (D3) System work like a direct debit in a bank: we can decide exactly what Data to share, for how long, to whom such data may be exchanged, and what return may be offered in the exchange. In this way, other individuals and applications can exchange their Data/Services with us, but only if we have agreed to do so, i.e. if we enabled their Accounts. For more details about enabling/disabling Data Debit Accounts, see section &ldquo;User Management&rdquo; at the beginning for this document. Any Data that belongs to the User can be bundled and shared from any Collection or directly from Source Data (e.g. Facebook), either at the level of individual Properties or entire Collections of Data.</p>

<h3 id="direct-debit-structure">Direct Debit Structure</h3>

<p>All Direct Debit API calls contain all the information defined in Direct Debit Structure. If you want to propose a new Direct Debit, you have to include the mandatory information in the API request. Direct Debit structure is explained in the table below.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Optional / Mandatory</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>universally unique identifier (UUID)/userId</td>
<td>mandatory</td>
</tr>
<tr>
<td>dateCreated</td>
<td>date when the direct debit was created</td>
<td>optional</td>
</tr>
<tr>
<td>lastUpdated</td>
<td>date when the direct debit was updated</td>
<td>optional</td>
</tr>
<tr>
<td>name</td>
<td>name of the direct debit</td>
<td>mandatory</td>
</tr>
<tr>
<td>startDate</td>
<td>local date and time when the direct debit starts</td>
<td>mandatory</td>
</tr>
<tr>
<td>startDate</td>
<td>local date and time when the direct debit ends</td>
<td>mandatory</td>
</tr>
<tr>
<td>rolling</td>
<td>boolean value: true or false</td>
<td>mandatory</td>
</tr>
<tr>
<td>sell</td>
<td>boolean value: true or false</td>
<td>mandatory</td>
</tr>
<tr>
<td>price</td>
<td>float value</td>
<td>mandatory</td>
</tr>
<tr>
<td>kind</td>
<td>contextless or contextual</td>
<td>mandatory</td>
</tr>
<tr>
<td>bundleContextless</td>
<td>string value: contextless bundles to be shared via direct debit</td>
<td>mandatory if kind is contextless</td>
</tr>
<tr>
<td>bundleContextual</td>
<td>string value: contextual bundles to be shared via direct debit</td>
<td>mandatory if kind is contextual</td>
</tr>
</tbody></table>

<h3 id="proposing-direct-data-debit">Proposing Direct Data Debit</h3>

<p>For a Direct Data Debit to be created, it first needs to be proposed to the user, who can then choose whether or not they would like to enable it.</p>

<p>To propose a new <code class="prettyprint">Direct Debit</code>, the API request body should contain all the mandatory information explained in the table above. The API request should then be posted to <code class="prettyprint">/dataDebit/propose</code> endpoint. </p>

<blockquote>
<p>Example of proposing a new Direct Debit:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -POST -d <span class="se">\ </span>
  <span class="s1">'{
     "name": "DD Kitchen electricity on weekend parties",
     "startDate": "2015-09-30T10:00:00Z",
     "endDate": "2015-10-30T10:00:00Z",
     "rolling": false,
     "sell": true,
     "price": 100.0,
     "kind": "contextless",
     "bundleContextless": 
     {
       "name": "Everything kitchen",
       "table": 
       {
         "id": 2,
         "name": "kitchen",
         "source": "fibaro"
       }
     }
   }'</span> <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/users/user"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">/dataDebit/propose</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DD Kitchen electricity on weekend parties"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-30T10:00:00Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-30T10:00:00Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"rolling"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"sell"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">100.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"contextless"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bundleContextless"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Everything kitchen"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"table"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kitchen"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fibaro"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Example of response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"rolling"</span>: <span class="nb">false</span>,
  <span class="s2">"name"</span>: <span class="s2">"DD Kitchen electricity on weekend parties"</span>,
  <span class="s2">"endDate"</span>: <span class="s2">"2015-10-30T10:00:00Z"</span>,
  <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-12-04T17:24:13Z"</span>,
  <span class="s2">"price"</span>: 100,
  <span class="s2">"key"</span>: <span class="s2">"cf0bce2e-8ff1-41b9-bb47-90c42c35eecb"</span>,
  <span class="s2">"dateCreated"</span>: <span class="s2">"2015-12-04T17:24:13Z"</span>,
  <span class="s2">"bundleContextless"</span>: 
  <span class="o">{</span>
    <span class="s2">"id"</span>: 3,
    <span class="s2">"dateCreated"</span>: <span class="s2">"2015-12-04T17:24:13Z"</span>,
    <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-12-04T17:24:13Z"</span>,
    <span class="s2">"name"</span>: <span class="s2">"Everything kitchen"</span>
  <span class="o">}</span>,
  <span class="s2">"kind"</span>: <span class="s2">"contextless"</span>,
  <span class="s2">"startDate"</span>: <span class="s2">"2015-09-30T10:00:00Z"</span>,
  <span class="s2">"sell"</span>: <span class="nb">true</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"rolling"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DD Kitchen electricity on weekend parties"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-30T10:00:00Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T17:24:13Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cf0bce2e-8ff1-41b9-bb47-90c42c35eecb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T17:24:13Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"bundleContextless"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T17:24:13Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T17:24:13Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Everything kitchen"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"contextless"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-30T10:00:00Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"sell"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<h3 id="enabling-disabling-direct-debit-requests">Enabling/Disabling Direct Debit Requests</h3>

<p>Consider a situation where you, owner of the HAT, receive a request from Direct Debit to read some of your Data. You can either enable or disable that request. To do this, you should make an API request using PUT to <code class="prettyprint">/directDebit/UUID/enable</code> or <code class="prettyprint">/directDebit/UUID/disable</code> endpoint to enable or disable the request respectively. Note that the API request body should be left empty and that UUID is a Direct Debit <code class="prettyprint">key</code> (see Direct Debit Structure table above). </p>

<blockquote>
<p>Example of enabling Data Debit:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -PUT <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/dataDebit/UUID/enable"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">PUT</span> <span class="nn">/dataDebit/UUID/enable</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code>OK
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="err">OK</span><span class="w">
</span></code></pre>

<h3 id="retrieving-data-debit-values">Retrieving Data Debit Values</h3>

<p>If a User enables a Data Debit (see &ldquo;Enabling/Disabling Direct Debit Requests&rdquo; above), then individuals or applications that proposed that Data Debit to you gain access to get your Data. Alternatively, if you proposed a Direct Debit and an individual enabled it, you can retrieve the Data yourself. To do this, you need to make a GET request to <code class="prettyprint">/dataDebit/UUID/values</code> endpoint.</p>

<blockquote>
<p>Example of retrieving Data Debit Values:</p>
</blockquote>
<pre class="highlight shell"><code>curl -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Accept: application/json"</span>  <span class="se">\</span>
  -H <span class="s2">"X-Auth-Token: ACCESS_TOKEN"</span>  <span class="se">\</span>
  -GET <span class="se">\</span>
  <span class="s2">"http://hat.hubofallthings.net/dataDebit/UUID/values"</span>
</code></pre>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">/dataDebit/UUID/values</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">hat.hubofallthings.net</span>
<span class="na">X-Auth-Token</span><span class="p">:</span> <span class="s">ACCESS_TOKEN</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
</code></pre>

<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"rolling"</span>: <span class="nb">false</span>,
  <span class="s2">"name"</span>: <span class="s2">"DD Kitchen electricity on weekend parties"</span>,
  <span class="s2">"endDate"</span>: <span class="s2">"2015-10-30T10:00:00Z"</span>,
  <span class="s2">"lastUpdated"</span>: <span class="s2">"2015-12-04T17:28:45Z"</span>,
  <span class="s2">"price"</span>: 100,
  <span class="s2">"key"</span>: <span class="s2">"cf0bce2e-8ff1-41b9-bb47-90c42c35eecb"</span>,
  <span class="s2">"dateCreated"</span>: <span class="s2">"2015-12-04T17:24:13Z"</span>,
  <span class="s2">"kind"</span>: <span class="s2">"contextless"</span>,
  <span class="s2">"startDate"</span>: <span class="s2">"2015-09-30T10:00:00Z"</span>,
  <span class="s2">"sell"</span>: <span class="nb">true</span>
<span class="o">}</span>
</code></pre>
<pre class="highlight http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="nt">"rolling"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DD Kitchen electricity on weekend parties"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-10-30T10:00:00Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"lastUpdated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T17:28:45Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cf0bce2e-8ff1-41b9-bb47-90c42c35eecb"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dateCreated"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-12-04T17:24:13Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"contextless"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-09-30T10:00:00Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"sell"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

          <h1 id="errors">Errors</h1>

<p>The HAT API uses the standard HTTP error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request has an error or tries to use the system in a way it is not supposed to</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your access_token or username/password is wrong or you are not permitted to access the resource</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The action you requested is not allowed for you: it belongs to somebody else or is too private</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified data could not be found</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The item requested has been removed from our servers</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re asking for too much! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

<p>Response body may optionally contain a more detailed explanation of the error</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="http">http</a>
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
